<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Manager Dashboard - Banking Verification</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* === BASE STYLES (MATCHING RTA) === */
    * { box-sizing: border-box; font-family: "Inter", sans-serif; }
    body { margin: 0; background-color: #f8fafc; color: #0f172a; min-height: 100vh; display: flex; flex-direction: column; }

    /* === HEADER === */
    header {
      background: linear-gradient(135deg, #0f172a, #1e293b); padding: 15px 40px; color: white;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15); position: sticky; top: 0; z-index: 100;
    }
    .brand { display: flex; align-items: center; gap: 12px; }
    .brand img { height: 32px; background: white; padding: 3px; border-radius: 6px; }
    .brand-text h1 { margin: 0; font-size: 16px; font-weight: 700; }
    .brand-text p { margin: 0; font-size: 11px; opacity: 0.7; }

    .user-profile { display: flex; align-items: center; gap: 20px; }
    .user-info { text-align: right; }
    .user-name { font-weight: 700; font-size: 15px; display: block; color: white; margin-bottom: 3px; }
    .user-details { display: flex; align-items: center; justify-content: flex-end; gap: 8px; }
    .meta-text { font-size: 11px; color: #cbd5e1; font-weight: 500; letter-spacing: 0.3px; }
    
    .role-badge {
      font-size: 10px; font-weight: 700; letter-spacing: 0.5px;
      background: rgba(124, 58, 237, 0.2); color: #a78bfa; /* Purple for Manager */
      border: 1px solid rgba(124, 58, 237, 0.4); padding: 2px 6px; border-radius: 4px; text-transform: uppercase;
    }

    .logout-btn {
      background: rgba(239, 68, 68, 0.15); color: #fca5a5;
      border: 1px solid rgba(239, 68, 68, 0.4); padding: 8px 14px;
      border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;
    }
    .logout-btn:hover { background: #ef4444; color: white; border-color: #ef4444; }

    /* === MAIN === */
    main { flex: 1; padding: 30px 40px; max-width: 1400px; margin: 0 auto; width: 100%; }

    /* === NAVIGATION & FILTER === */
    .dashboard-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
    .nav-tabs { display: flex; gap: 10px; background: white; padding: 6px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); width: fit-content; }
    .nav-item {
      padding: 10px 20px; font-size: 13px; font-weight: 600; color: #64748b; 
      cursor: pointer; border-radius: 8px; transition: all 0.2s; display: flex; align-items: center; gap: 8px;
    }
    .nav-item:hover { background: #f1f5f9; color: #0f172a; }
    .nav-item.active { background: #e0f2fe; color: #0284c7; }

    .year-filter {
      padding: 10px 16px; border-radius: 10px; border: 1px solid #cbd5e1;
      font-size: 14px; font-weight: 600; color: #1e293b; outline: none; cursor: pointer;
      background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    /* === GRID & PANELS === */
    .grid-container { display: grid; grid-template-columns: 2fr 1fr; gap: 24px; animation: fadeIn 0.4s ease; }
    .full-width { grid-column: span 2; }
    .panel {
      background: white; border-radius: 16px; padding: 24px;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); border: 1px solid #f1f5f9;
      height: 100%; display: flex; flex-direction: column;
    }
    .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .panel-title { font-size: 15px; font-weight: 700; color: #1e293b; margin: 0; }

    /* === STATS ROW === */
    .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 24px; }
    .stat-card {
      background: white; padding: 20px; border-radius: 12px; border: 1px solid #e2e8f0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.02); transition: transform 0.2s;
    }
    .stat-card:hover { transform: translateY(-2px); border-color: #38bdf8; }
    .stat-label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
    .stat-value { font-size: 24px; font-weight: 700; color: #0f172a; }

    /* === PERSONAL INFO CARDS === */
    .personal-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
    .p-card { background: white; padding: 20px; border-radius: 12px; border-top: 4px solid #cbd5e1; box-shadow: 0 2px 10px rgba(0,0,0,0.03); text-align: center; }
    .p-val { font-size: 28px; font-weight: 700; margin-top: 10px; color: #334155; }
    .p-lbl { font-size: 12px; color: #64748b; font-weight: 600; }
    .pc-blue { border-color: #3b82f6; } .pc-cyan { border-color: #06b6d4; } .pc-red { border-color: #ef4444; } .pc-green { border-color: #10b981; }

    /* === FORMS & BUTTONS === */
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; font-size: 12px; font-weight: 600; color: #475569; margin-bottom: 6px; }
    .form-control { width: 100%; padding: 10px 14px; border-radius: 8px; border: 1px solid #cbd5e1; font-size: 14px; outline: none; background: #fff; }
    .btn-primary { width: 100%; padding: 12px; background: linear-gradient(135deg, #0ea5e9, #2563eb); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
    .btn-primary:hover { transform: translateY(-2px); }
    .btn-danger { width: 100%; padding: 12px; background: #fee2e2; color: #991b1b; border: 1px solid #fecaca; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
    .btn-danger:hover { background: #fca5a5; }

    /* === TABLE STYLES === */
    .search-bar { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #cbd5e1; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; }
    th { text-align: left; padding: 12px; font-size: 11px; color: #64748b; text-transform: uppercase; background: #f8fafc; border-bottom: 2px solid #e2e8f0; }
    td { padding: 10px 12px; font-size: 13px; color: #334155; border-bottom: 1px solid #f1f5f9; vertical-align: middle; }
    
    .karyawan-cell { display: flex; flex-direction: column; gap: 3px; }
    .k-name { font-weight: 700; font-size: 14px; color: #0f172a; }
    .k-meta { display: flex; align-items: center; gap: 6px; font-size: 11px; color: #64748b; }
    
    /* BADGES */
    .mini-badge { padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: 700; text-transform: uppercase; white-space: nowrap; }
    .mb-val { background: #eff6ff; color: #1d4ed8; border: 1px solid #dbeafe; } 
    .mb-ver { background: #ecfdf5; color: #047857; border: 1px solid #d1fae5; } 
    .mb-mgr { background: #f3e8ff; color: #7e22ce; border: 1px solid #e9d5ff; } 
    .mb-spv { background: #fff7ed; color: #c2410c; border: 1px solid #ffedd5; } 
    .mb-rta { background: #fef2f2; color: #b91c1c; border: 1px solid #fee2e2; } 
    .mb-stf { background: #f8fafc; color: #475569; border: 1px solid #e2e8f0; } 

    .status-badge { padding: 3px 8px; border-radius: 12px; font-size: 10px; font-weight: 700; }
    .bg-green { background: #dcfce7; color: #166534; } .bg-red { background: #fee2e2; color: #991b1b; }

    footer { text-align: center; padding: 20px; color: #94a3b8; font-size: 11px; border-top: 1px solid #e2e8f0; margin-top: auto; }

    /* === MODALS === */
    .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(15,23,42,0.6); backdrop-filter: blur(4px); display: none; justify-content: center; align-items: center; z-index: 1000; }
    .modal-box { background: white; padding: 30px; border-radius: 20px; width: 340px; text-align: center; animation: popUp 0.4s ease; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
    .modal-btn-group { display: flex; gap: 10px; margin-top: 20px; }
    .btn-cancel { flex:1; padding: 10px; border: 1px solid #cbd5e1; background: white; border-radius: 8px; cursor: pointer; font-weight: 600; color: #64748b; }
    .btn-confirm { flex:1; padding: 10px; border: none; background: #0ea5e9; color: white; border-radius: 8px; cursor: pointer; font-weight: 600; }
    .btn-confirm-danger { flex:1; padding: 10px; border: none; background: #ef4444; color: white; border-radius: 8px; cursor: pointer; font-weight: 600; }
    @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .modal-open { display: flex; }
    
    #loadingOverlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(255,255,255,0.85); z-index: 2000; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(2px); }
    .spinner { width: 40px; height: 40px; border: 4px solid #e2e8f0; border-top-color: #0ea5e9; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

  <div id="loadingOverlay"><div class="spinner"></div></div>

  <header>
    <div class="brand">
      <img src="data:image/png;base64,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" alt="Logo">
      <div class="brand-text"><h1>Banking Verification</h1><p>Leave Monitoring System</p></div>
    </div>
    <div class="user-profile">
      <div class="user-info">
        <span class="user-name" id="dispName">Loading...</span>
        <div class="user-details"><span class="meta-text" id="dispMeta">...</span><span class="role-badge">SUPER ADMINISTRATOR</span></div>
      </div>
      <button class="logout-btn" onclick="confirmLogout()">Sign Out</button>
    </div>
  </header>

  <main>
    <div class="dashboard-header">
      <div class="nav-tabs">
        <div class="nav-item active" onclick="switchTab('dashboard')">üìä Dashboard</div>
        <div class="nav-item" onclick="switchTab('infoPribadi')">üë§ Info Pribadi</div>
        <div class="nav-item" onclick="switchTab('monitoringOfficer')">üëÆ‚Äç‚ôÇÔ∏è Monitoring Officer</div>
        <div class="nav-item" onclick="switchTab('inputCuti')">üìù Input Cuti</div>
        <div class="nav-item" onclick="switchTab('dataKaryawan')">üë• Data Karyawan</div>
        <div class="nav-item" onclick="switchTab('settings')">‚öôÔ∏è Admin Tools</div>
      </div>
      <div id="dashboardFilter" style="display:block;">
        <select id="filterYear" class="year-filter" onchange="loadData()">
          <option value="2026">2026</option>
          <option value="2027">2027</option>
          <option value="2028">2028</option>
        </select>
      </div>
    </div>

    <div id="view_dashboard">
      <div class="stats-row">
        <div class="stat-card"><div class="stat-label">Total Karyawan</div><div class="stat-value" id="statTotalUser">0</div></div>
        <div class="stat-card"><div class="stat-label">Total Cuti Diambil</div><div class="stat-value" id="statTotalUsed" style="color:#ef4444">0</div></div>
        <div class="stat-card"><div class="stat-label">Rata-rata Saldo</div><div class="stat-value" id="statAvgSaldo" style="color:#0ea5e9">0</div></div>
        <div class="stat-card"><div class="stat-label">Periode Data</div><div class="stat-value" id="statSysYear">...</div></div>
      </div>
      <div class="grid-container">
        <div class="panel full-width"><div class="panel-header"><h3 class="panel-title">üìà Tren Penggunaan Cuti (14 Bulan)</h3></div><div style="height: 300px;"><canvas id="chartMonthly"></canvas></div></div>
        <div class="panel"><div class="panel-header"><h3 class="panel-title">Distribusi Level</h3></div><div style="height: 250px;"><canvas id="chartLevel"></canvas></div></div>
        <div class="panel"><div class="panel-header"><h3 class="panel-title">Distribusi Status</h3></div><div style="height: 250px; display:flex; justify-content:center;"><canvas id="chartStatus"></canvas></div></div>
        <div class="panel full-width"><div class="panel-header"><h3 class="panel-title">üèÜ Top 5 Pengguna Cuti Tertinggi</h3></div><table id="topUserTable"></table></div>
      </div>
    </div>

    <div id="view_infoPribadi" style="display: none;">
      <div class="personal-grid">
        <div class="p-card pc-blue"><div class="p-lbl">HAK CUTI SAYA</div><div class="p-val" id="myHak">0</div></div>
        <div class="p-card pc-cyan"><div class="p-lbl">BONUS SAYA</div><div class="p-val" id="myBonus">0</div></div>
        <div class="p-card pc-red"><div class="p-lbl">SAYA AMBIL</div><div class="p-val" id="myUsed" style="color:#ef4444">0</div></div>
        <div class="p-card pc-green"><div class="p-lbl">SISA SALDO</div><div class="p-val" id="mySaldo" style="color:#10b981">0</div></div>
      </div>
      <div class="panel full-width"><div class="panel-header"><h3 class="panel-title">Riwayat Cuti Tahunan Saya</h3></div><table id="myHistoryTable"><thead><tr><th>Tahun</th><th>Hak Accrual</th><th>Bonus</th><th>Total Hak</th><th>Used</th><th>Sisa Saldo</th><th>Status</th></tr></thead><tbody></tbody></table></div>
    </div>

    <div id="view_monitoringOfficer" style="display: none;">
      <div class="panel">
        <div class="panel-header">
          <h3 class="panel-title">üëÆ‚Äç‚ôÇÔ∏è Monitoring Officer (RTA & Supervisor Only)</h3>
          <input type="text" id="searchOfficer" class="search-bar" style="width: 300px; margin:0;" placeholder="Cari nama officer..." onkeyup="renderOfficerTable()">
        </div>
        <div style="overflow-x: auto;">
          <table id="officerTable">
            <thead><tr><th>Officer</th><th>Tim</th><th>Hak</th><th>Bonus</th><th>Used</th><th>Saldo</th><th>Status</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="view_inputCuti" style="display: none;">
      <div class="grid-container">
        <div class="panel full-width" style="max-width: 600px; margin: 0 auto;">
          <div class="panel-header"><h3 class="panel-title">Form Input Cuti Manual</h3></div>
          <div class="form-group"><label>Pilih Karyawan</label><input list="employeeList" id="inpTarget" class="form-control" placeholder="Ketik nama/ID..." autocomplete="off"><datalist id="employeeList"></datalist></div>
          <div class="form-grid">
            <div class="form-group"><label>Tahun Dasar</label><select id="inpYear" class="form-control"><option value="2026">2026</option><option value="2027">2027</option></select></div>
            <div class="form-group">
              <label>Bulan Penggunaan</label>
              <select id="inpMonth" class="form-control">
                <option value="Jan">Januari</option><option value="Feb">Februari</option><option value="Mar">Maret</option>
                <option value="Apr">April</option><option value="May">Mei</option><option value="Jun">Juni</option>
                <option value="Jul">Juli</option><option value="Aug">Agustus</option><option value="Sep">September</option>
                <option value="Oct">Oktober</option><option value="Nov">November</option><option value="Dec">Desember</option>
                <option disabled>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</option>
                <option value="jan_next">Januari (Tahun Depan)</option><option value="feb_next">Februari (Tahun Depan)</option>
              </select>
              <small style="color:#64748b; font-size:11px;">*Pilih opsi Next Year untuk cuti carry-over</small>
            </div>
          </div>
          <div class="form-group"><label>Jumlah Hari</label><input type="number" id="inpQty" class="form-control" placeholder="0" min="1"></div>
          <button class="btn-primary" onclick="submitLeave()">Simpan Data</button>
        </div>
      </div>
    </div>

    <div id="view_dataKaryawan" style="display: none;">
      <div class="panel"><div class="panel-header"><h3 class="panel-title">Database Seluruh Karyawan</h3><input type="text" id="searchEmp" class="search-bar" style="width: 300px; margin:0;" placeholder="Cari nama..." onkeyup="renderTable()"></div><div style="overflow-x: auto;"><table id="empTable"><thead><tr><th>Karyawan</th><th>Tim</th><th>Hak</th><th>Bonus</th><th>Used</th><th>Saldo</th><th>Status</th></tr></thead><tbody></tbody></table></div></div>
    </div>

    <div id="view_settings" style="display: none;">
      <div class="grid-container">
        <div class="panel">
          <div class="panel-header"><h3 class="panel-title">üìÖ Tahun Sistem</h3></div>
          <p style="font-size:13px; color:#64748b; margin-bottom:15px;">Tahun aktif aplikasi (Cell Z1).</p>
          <div class="form-group"><select id="setSysYear" class="form-control"><option value="2026">2026</option><option value="2027">2027</option><option value="2028">2028</option></select></div>
          <button class="btn-primary" style="background: #334155;" onclick="changeSystemYear()">Update Tahun</button>
        </div>
        <div class="panel">
          <div class="panel-header"><h3 class="panel-title">üéÅ Aktivasi Bonus</h3></div>
          <p style="font-size:13px; color:#64748b; margin-bottom:15px;">Aktifkan bonus cuti 1 hari.</p>
          <div class="form-group"><input list="employeeList" id="inpBonusTarget" class="form-control" placeholder="Cari nama/ID..."></div>
          <button class="btn-primary" style="background: #059669;" onclick="activateBonus()">Aktifkan Bonus</button>
        </div>
        <div class="panel full-width">
          <div class="panel-header"><h3 class="panel-title" style="color:#ef4444;">üö® Reset Password Karyawan</h3></div>
          <p style="font-size:13px; color:#64748b; margin-bottom:15px;">Pilih karyawan untuk mereset password menjadi default <b>(privy123)</b>.</p>
          <div class="form-group"><input list="employeeList" id="inpResetTarget" class="form-control" placeholder="Cari nama/ID..."></div>
          <button class="btn-danger" onclick="confirmReset()">Reset Password User Ini</button>
        </div>
      </div>
    </div>
  </main>

  <footer>¬© 2026 Banking Verification Division ‚Äì Privy</footer>

  <div id="msgModal" class="modal-overlay"><div class="modal-box"><h3 id="msgTitle" style="margin:0 0 10px 0; color:#0f172a;">Info</h3><p id="msgBody" style="font-size:14px; color:#64748b; margin-bottom:20px;">...</p><button class="btn-primary" onclick="closeModal()">OK</button></div></div>
  <div id="logoutModal" class="modal-overlay"><div class="modal-box"><h3 style="margin-top:0">Konfirmasi Sign Out</h3><p style="color:#64748b; font-size:14px; margin-bottom:20px;">Yakin ingin keluar?</p><div class="modal-btn-group"><button class="btn-cancel" onclick="closeLogout()">Batal</button><button class="btn-confirm-danger" onclick="doLogout()">Ya, Keluar</button></div></div></div>

<script>
// CONFIG
const API_URL = "https://script.google.com/macros/s/AKfycbx88xE9HDhQqSgxpogcWEpOFvKjv_gpWFiPu4qJLfXuqk4rxw9o9Xnh_V-F1_Ax2IjB/exec";
const user = JSON.parse(localStorage.getItem("user"));
if(!user || user.role !== "MANAGER") window.location = "login.html";

document.getElementById("dispName").innerText = user.name;
document.getElementById("dispMeta").innerText = `${user.privyId} | ${user.position}`;

let allData = [];
let charts = {};

window.onload = function() {
    document.getElementById("filterYear").value = "2026"; 
    loadData();
    loadMyHistory();
};

async function loadData() {
  showLoading(true);
  try {
    const filterYr = document.getElementById("filterYear").value;
    let res = await fetch(`${API_URL}?act=getSummary&privyId=${user.privyId}&role=RTA&viewYear=${filterYr}`);
    let data = await res.json();
    if (!Array.isArray(data)) { console.log("Data invalid"); showLoading(false); return; }
    
    allData = data;
    const myData = data.find(r => r.privyId === user.privyId);
    if(myData) renderMyOverview(myData);

    calculateStats(data);
    renderAllCharts(data);
    populateDatalist(data);
    renderTable();
    renderOfficerTable(); // New Function for Monitoring Officer
  } catch(e) { console.error(e); } finally { showLoading(false); }
}

async function loadMyHistory() {
  try {
    let res = await fetch(`${API_URL}?act=getDetail&privyId=${user.privyId}&role=RTA`);
    let data = await res.json();
    renderMyHistoryTable(data);
  } catch(e) { console.error("History fail"); }
}

function renderMyOverview(d) {
  document.getElementById("myHak").innerText = d.hakBerjalan;
  document.getElementById("myBonus").innerText = d.bonusActive;
  document.getElementById("myUsed").innerText = d.diambil;
  document.getElementById("mySaldo").innerText = d.saldo;
}

function renderMyHistoryTable(data) {
  const tbody = document.querySelector("#myHistoryTable tbody");
  tbody.innerHTML = "";
  const myData = data.filter(r => r.privyId === user.privyId);
  myData.sort((a,b) => b.tahun - a.tahun);
  myData.forEach(r => {
    let badge = r.status === "AMAN" ? "bg-green" : "bg-red";
    tbody.innerHTML += `<tr><td style="font-weight:600">${r.tahun}</td><td>${r.hakAccrual}</td><td>${r.bonusActive}</td><td>${r.totalHak}</td><td style="color:#ef4444; font-weight:600">${r.used}</td><td style="font-weight:700">${r.sisa}</td><td><span class="status-badge ${badge}">${r.status}</span></td></tr>`;
  });
}

function calculateStats(data) {
  document.getElementById("statTotalUser").innerText = data.length;
  let totalUsed = 0; let totalSaldo = 0;
  data.forEach(r => { totalUsed += (r.diambil || 0); totalSaldo += (r.saldo || 0); });
  document.getElementById("statTotalUsed").innerText = totalUsed;
  document.getElementById("statAvgSaldo").innerText = (data.length > 0) ? (totalSaldo / data.length).toFixed(1) : "0";
  document.getElementById("statSysYear").innerText = document.getElementById("filterYear").value;
}

// CHART 14 MONTHS
function renderAllCharts(data) {
  const destroyChart = (id) => { if(charts[id]) charts[id].destroy(); };
  destroyChart('chartMonthly');
  const months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec', 'jan_next', 'feb_next'];
  let monthlyTotals = new Array(14).fill(0);
  data.forEach(r => { months.forEach((m, i) => { monthlyTotals[i] += (r[m] || 0); }); });
  const currentYear = document.getElementById("filterYear").value;
  const nextYear = parseInt(currentYear) + 1;

  charts['chartMonthly'] = new Chart(document.getElementById('chartMonthly'), {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des', `Jan ${nextYear}`, `Feb ${nextYear}`],
      datasets: [{ label: `Total Cuti (${currentYear} - Feb ${nextYear})`, data: monthlyTotals, borderColor: '#0ea5e9', backgroundColor: 'rgba(14, 165, 233, 0.1)', borderWidth: 2, tension: 0.4, fill: true }]
    },
    options: { maintainAspectRatio: false, scales: { y: { beginAtZero: true } }, plugins: { legend: { display: false } } }
  });

  destroyChart('chartLevel');
  let grpLead = 0, grpOff = 0, grpStf = 0;
  data.forEach(r => {
    let p = (r.position||"").toLowerCase(), rl = (r.role||"").toLowerCase(), u = r.diambil||0;
    if(rl==='manager'||rl==='rta'||rl==='supervisor') grpLead+=u; else if(p.includes('validator')||p.includes('verifier')) grpOff+=u; else grpStf+=u;
  });
  charts['chartLevel'] = new Chart(document.getElementById('chartLevel'), { type: 'bar', data: { labels: ['Leadership', 'Officer', 'Staff'], datasets: [{ label: 'Total', data: [grpLead, grpOff, grpStf], backgroundColor: ['#6366f1', '#f59e0b', '#64748b'], borderRadius: 6 }] }, options: { maintainAspectRatio: false } });

  destroyChart('chartStatus');
  let aman = data.filter(r => r.status === "AMAN").length;
  let hutang = data.filter(r => r.status === "HUTANG").length;
  charts['chartStatus'] = new Chart(document.getElementById('chartStatus'), { type: 'doughnut', data: { labels: ['Aman', 'Hutang'], datasets: [{ data: [aman, hutang], backgroundColor: ['#10b981', '#ef4444'], borderWidth: 0 }] }, options: { maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } } });

  let sorted = [...data].sort((a,b) => b.diambil - a.diambil).slice(0, 5);
  let html = "";
  sorted.forEach(r => html += `<tr><td style="padding:8px; border-bottom:1px solid #f1f5f9; font-size:13px;">${r.name}</td><td style="font-weight:700; color:#ef4444; text-align:right;">${r.diambil}</td></tr>`);
  document.getElementById("topUserTable").innerHTML = html;
}

// MAIN TABLE
function renderTable() {
  const q = document.getElementById("searchEmp").value.toLowerCase();
  const tbody = document.querySelector("#empTable tbody");
  tbody.innerHTML = "";
  let filtered = allData.filter(r => r.name.toLowerCase().includes(q) || r.privyId.toLowerCase().includes(q));
  
  filtered.sort((a, b) => {
    const getRank = (row) => { let r = (row.role||"").toUpperCase(), p = (row.position||"").toUpperCase(); if(r==="MANAGER") return 1; if(r==="RTA") return 2; if(r==="SUPERVISOR") return 3; if(p.includes("VALIDATOR")) return 4; if(p.includes("VERIFIER")) return 5; return 6; };
    return getRank(a) - getRank(b) || a.name.localeCompare(b.name);
  });

  filtered.forEach(r => {
    let p = (r.position||"").toLowerCase(), rl = (r.role||"").toLowerCase();
    let badgeCls = "mb-stf"; if(rl==="manager") badgeCls="mb-mgr"; else if(rl==="rta") badgeCls="mb-rta"; else if(rl==="supervisor") badgeCls="mb-spv"; else if(p.includes("validator")) badgeCls="mb-val"; else if(p.includes("verifier")) badgeCls="mb-ver";
    let stBadge = r.status==="AMAN" ? "bg-green" : "bg-red";
    tbody.innerHTML += `<tr><td class="karyawan-cell"><div class="k-name">${r.name}</div><div class="k-meta"><span>${r.privyId}</span> <span class="mini-badge ${badgeCls}">${r.position}</span></div></td><td>${r.team}</td><td>${r.hakBerjalan}</td><td>${r.bonusActive}</td><td style="color:#ef4444; font-weight:600">${r.diambil}</td><td style="font-weight:700">${r.saldo}</td><td><span class="status-badge ${stBadge}">${r.status}</span></td></tr>`;
  });
}

// NEW: OFFICER TABLE (RTA & SPV ONLY)
function renderOfficerTable() {
  const q = document.getElementById("searchOfficer").value.toLowerCase();
  const tbody = document.querySelector("#officerTable tbody");
  tbody.innerHTML = "";
  
  // Filter RTA/SUPERVISOR only
  let filtered = allData.filter(r => {
    const role = (r.role || "").toUpperCase();
    return (role === "RTA" || role === "SUPERVISOR") && (r.name.toLowerCase().includes(q) || r.privyId.toLowerCase().includes(q));
  });
  
  filtered.forEach(r => {
    let rl = (r.role||"").toLowerCase();
    let badgeCls = rl==="rta" ? "mb-rta" : "mb-spv";
    let stBadge = r.status==="AMAN" ? "bg-green" : "bg-red";
    tbody.innerHTML += `<tr><td class="karyawan-cell"><div class="k-name">${r.name}</div><div class="k-meta"><span>${r.privyId}</span> <span class="mini-badge ${badgeCls}">${r.position}</span></div></td><td>${r.team}</td><td>${r.hakBerjalan}</td><td>${r.bonusActive}</td><td style="color:#ef4444; font-weight:600">${r.diambil}</td><td style="font-weight:700">${r.saldo}</td><td><span class="status-badge ${stBadge}">${r.status}</span></td></tr>`;
  });
}

function populateDatalist(data) {
  let opts = ""; data.forEach(r => opts += `<option value="${r.privyId}"> ${r.name} - ${r.position}</option>`);
  document.getElementById("employeeList").innerHTML = opts;
}

// ACTIONS
async function submitLeave() {
  const target = document.getElementById("inpTarget").value;
  let year = document.getElementById("inpYear").value;
  let month = document.getElementById("inpMonth").value; 
  const qty = document.getElementById("inpQty").value;
  if(!target || !qty) return showMsg("Error", "Lengkapi data.");
  if(month.includes("_next")) { year = parseInt(year) + 1; month = month.replace("_next", ""); }
  showLoading(true);
  try {
    let res = await fetch(`${API_URL}?act=addLeave&targetId=${target}&year=${year}&month=${month}&qty=${qty}&role=RTA`);
    let json = await res.json();
    if(json.status==="OK") { showMsg("Sukses", `Disimpan.`); await loadData(); } else { showMsg("Gagal", json.message); showLoading(false); }
  } catch(e) { showLoading(false); }
}

async function activateBonus() {
  const target = document.getElementById("inpBonusTarget").value;
  if(!target) return showMsg("Error", "Pilih karyawan.");
  showLoading(true);
  try {
    let res = await fetch(`${API_URL}?act=activateBonus&targetId=${target}&role=RTA`);
    let json = await res.json();
    if(json.status==="OK") { showMsg("Sukses", "Bonus Aktif."); await loadData(); } else { showMsg("Gagal", json.message); showLoading(false); }
  } catch(e) { showLoading(false); }
}

async function changeSystemYear() {
  const yr = document.getElementById("setSysYear").value;
  showLoading(true);
  try {
    let res = await fetch(`${API_URL}?act=setAppYear&year=${yr}&role=RTA`);
    let json = await res.json();
    showLoading(false);
    if(json.status==="OK") { showMsg("Sukses", "Tahun berubah ke " + yr); setTimeout(()=>location.reload(), 1000); }
  } catch(e) { showLoading(false); }
}

// RESET PASSWORD
function confirmReset() {
  const target = document.getElementById("inpResetTarget").value;
  if(!target) return showMsg("Error", "Pilih karyawan.");
  if(confirm(`PERINGATAN: Reset password ${target} menjadi 'privy123'?`)) { doResetUser(target); }
}
async function doResetUser(targetId) {
  showLoading(true);
  try {
    let res = await fetch(`${API_URL}?act=resetUserPassword&targetId=${targetId}&role=RTA`);
    let json = await res.json();
    showLoading(false);
    if(json.status==="OK") { showMsg("Sukses", `Password ${targetId} direset.`); } else { showMsg("Gagal", json.message); }
  } catch(e) { showLoading(false); showMsg("Error", "Koneksi Gagal"); }
}

function switchTab(id) {
  document.querySelectorAll(".nav-item").forEach(el => el.classList.remove("active"));
  event.currentTarget.classList.add("active");
  ["view_dashboard", "view_infoPribadi", "view_monitoringOfficer", "view_inputCuti", "view_dataKaryawan", "view_settings"].forEach(v => document.getElementById(v).style.display = "none");
  document.getElementById("view_" + id).style.display = "block";
  document.getElementById("dashboardFilter").style.display = (id === "dashboard") ? "block" : "none";
}

function showLoading(s) { document.getElementById("loadingOverlay").style.display = s ? "flex" : "none"; }
function showMsg(t, b) { document.getElementById("msgTitle").innerText=t; document.getElementById("msgBody").innerText=b; document.getElementById("msgModal").classList.add("modal-open"); }
function closeModal() { document.getElementById("msgModal").classList.remove("modal-open"); }
function confirmLogout() { document.getElementById("logoutModal").classList.add("modal-open"); }
function closeLogout() { document.getElementById("logoutModal").classList.remove("modal-open"); }
function doLogout() { localStorage.removeItem("user"); window.location="login.html"; }
</script>
</body>
</html>